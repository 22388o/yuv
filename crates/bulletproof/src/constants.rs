extern crate alloc;

use alloc::vec::Vec;

use k256::elliptic_curve::{ff::PrimeField, group::GroupEncoding, sec1::FromEncodedPoint};
use sha2::{Digest, Sha256};

/// The size in bytes of a range proof.
pub const RANGE_PROOF_SIZE: usize = 64;

/// The group of points generated by G.
/// This is used to calculate the seed parameter from blinding factors.
///
/// For details: https://eprint.iacr.org/2020/735
const RAW_G_BOLD1: &[&[u8]] = &[
    &[
        2, 174, 222, 91, 156, 50, 179, 223, 75, 197, 42, 68, 228, 209, 71, 171, 96, 82, 111, 51,
        33, 253, 245, 235, 89, 253, 93, 137, 58, 78, 106, 56, 29,
    ],
    &[
        2, 248, 153, 11, 92, 186, 207, 134, 1, 203, 199, 163, 104, 250, 58, 216, 63, 62, 179, 178,
        64, 42, 110, 117, 47, 27, 237, 110, 79, 129, 173, 186, 100,
    ],
    &[
        2, 101, 92, 98, 167, 46, 229, 28, 228, 136, 229, 6, 11, 225, 45, 240, 231, 127, 20, 93, 24,
        11, 224, 234, 90, 214, 54, 77, 128, 200, 213, 84, 115,
    ],
    &[
        3, 168, 141, 252, 121, 174, 2, 154, 187, 68, 74, 68, 67, 167, 116, 126, 36, 255, 185, 208,
        208, 219, 215, 176, 224, 242, 20, 213, 110, 191, 182, 172, 66,
    ],
    &[
        3, 172, 64, 69, 21, 78, 38, 199, 31, 0, 45, 201, 61, 96, 1, 204, 193, 36, 161, 255, 172,
        77, 25, 115, 126, 48, 44, 204, 188, 167, 135, 204, 22,
    ],
    &[
        2, 88, 80, 132, 115, 137, 202, 224, 176, 8, 108, 162, 93, 233, 97, 98, 52, 163, 145, 8, 53,
        158, 86, 37, 247, 25, 163, 66, 48, 118, 14, 7, 247,
    ],
    &[
        2, 33, 10, 153, 203, 119, 76, 126, 96, 116, 155, 224, 190, 2, 110, 14, 60, 6, 94, 33, 48,
        93, 255, 79, 192, 153, 139, 42, 16, 149, 6, 100, 105,
    ],
    &[
        2, 72, 148, 156, 182, 90, 237, 135, 95, 172, 185, 249, 47, 187, 187, 94, 120, 219, 189, 45,
        145, 145, 137, 218, 182, 210, 31, 6, 143, 65, 135, 196, 90,
    ],
    &[
        3, 70, 47, 49, 62, 235, 44, 101, 33, 33, 195, 14, 173, 167, 23, 121, 106, 190, 53, 144,
        146, 20, 0, 178, 229, 12, 79, 46, 234, 139, 167, 196, 205,
    ],
    &[
        3, 214, 150, 203, 146, 72, 193, 78, 60, 201, 43, 215, 64, 127, 148, 58, 94, 116, 226, 66,
        214, 103, 227, 80, 207, 238, 246, 4, 138, 87, 56, 217, 246,
    ],
    &[
        2, 135, 177, 241, 193, 139, 89, 156, 210, 133, 173, 214, 82, 189, 139, 41, 32, 37, 108,
        111, 228, 4, 217, 4, 219, 159, 193, 217, 199, 180, 231, 76, 60,
    ],
    &[
        3, 33, 140, 139, 118, 244, 54, 199, 195, 118, 67, 17, 181, 57, 174, 248, 206, 20, 228, 238,
        141, 58, 224, 229, 70, 108, 157, 232, 165, 71, 137, 234, 33,
    ],
    &[
        3, 255, 61, 143, 140, 202, 99, 164, 227, 232, 167, 57, 237, 191, 244, 252, 32, 177, 59,
        176, 177, 214, 59, 161, 133, 244, 50, 29, 56, 6, 111, 84, 45,
    ],
    &[
        2, 234, 15, 90, 9, 203, 1, 33, 164, 160, 39, 13, 126, 89, 98, 44, 18, 164, 80, 161, 115,
        238, 18, 237, 130, 191, 71, 22, 163, 27, 193, 13, 128,
    ],
    &[
        2, 184, 211, 216, 180, 193, 231, 210, 176, 201, 191, 176, 184, 119, 236, 175, 103, 214, 70,
        88, 96, 199, 51, 41, 39, 171, 17, 7, 136, 153, 93, 95, 52,
    ],
    &[
        2, 51, 56, 61, 92, 125, 107, 26, 80, 77, 95, 96, 135, 150, 115, 236, 124, 198, 52, 216,
        176, 2, 155, 210, 12, 39, 95, 147, 5, 241, 155, 90, 97,
    ],
    &[
        2, 238, 149, 123, 242, 132, 234, 43, 223, 3, 73, 31, 48, 72, 81, 247, 5, 199, 149, 204,
        130, 238, 64, 53, 75, 223, 166, 218, 245, 143, 223, 123, 83,
    ],
    &[
        3, 135, 55, 48, 214, 11, 136, 56, 94, 167, 28, 228, 74, 250, 162, 100, 191, 170, 55, 242,
        24, 141, 171, 96, 197, 137, 243, 164, 215, 211, 154, 242, 66,
    ],
    &[
        2, 214, 9, 155, 225, 141, 63, 154, 72, 72, 57, 62, 48, 50, 239, 135, 250, 82, 81, 14, 22,
        239, 111, 105, 66, 48, 124, 185, 103, 26, 86, 9, 93,
    ],
    &[
        3, 89, 81, 118, 138, 210, 30, 134, 238, 172, 157, 127, 245, 74, 4, 229, 146, 205, 20, 142,
        220, 29, 45, 37, 146, 109, 230, 92, 172, 228, 152, 112, 218,
    ],
    &[
        3, 154, 195, 155, 1, 60, 32, 187, 249, 124, 115, 81, 176, 49, 239, 22, 166, 79, 200, 118,
        27, 16, 0, 216, 115, 220, 155, 223, 12, 214, 124, 1, 122,
    ],
    &[
        2, 235, 125, 16, 178, 65, 46, 248, 143, 228, 156, 17, 137, 207, 77, 242, 113, 102, 233, 91,
        18, 71, 46, 67, 109, 121, 72, 222, 124, 165, 32, 180, 7,
    ],
    &[
        2, 168, 154, 41, 146, 194, 169, 107, 166, 132, 148, 168, 111, 246, 148, 69, 82, 181, 214,
        198, 95, 208, 20, 57, 230, 65, 116, 54, 148, 123, 38, 87, 108,
    ],
    &[
        2, 115, 197, 128, 153, 22, 122, 63, 34, 40, 19, 161, 89, 23, 227, 115, 79, 196, 175, 93,
        74, 34, 42, 161, 73, 3, 48, 56, 251, 102, 215, 229, 73,
    ],
    &[
        3, 125, 88, 3, 59, 159, 246, 5, 163, 240, 99, 174, 73, 21, 98, 122, 46, 233, 98, 213, 50,
        114, 103, 0, 234, 60, 57, 153, 81, 233, 185, 95, 42,
    ],
    &[
        3, 229, 150, 90, 29, 240, 22, 160, 215, 227, 202, 107, 152, 61, 159, 152, 63, 203, 23, 118,
        169, 244, 167, 195, 117, 129, 231, 108, 131, 102, 187, 106, 68,
    ],
    &[
        2, 17, 252, 216, 224, 36, 164, 214, 38, 35, 191, 46, 181, 25, 11, 35, 169, 14, 245, 110,
        229, 16, 88, 241, 116, 140, 192, 196, 201, 245, 145, 31, 166,
    ],
    &[
        2, 36, 150, 242, 39, 213, 1, 75, 253, 91, 52, 198, 144, 178, 158, 1, 74, 216, 177, 182, 94,
        180, 174, 63, 0, 6, 201, 155, 0, 21, 216, 208, 197,
    ],
    &[
        2, 101, 26, 69, 132, 11, 171, 0, 103, 163, 211, 32, 45, 149, 127, 84, 25, 137, 217, 131,
        21, 81, 241, 126, 38, 79, 83, 166, 133, 252, 21, 0, 136,
    ],
    &[
        2, 46, 248, 4, 198, 171, 91, 54, 64, 212, 252, 177, 218, 122, 225, 6, 216, 243, 222, 236,
        184, 3, 250, 221, 8, 125, 30, 133, 103, 185, 193, 199, 22,
    ],
    &[
        2, 75, 128, 178, 95, 114, 47, 195, 230, 39, 65, 221, 120, 60, 99, 44, 157, 216, 199, 11,
        103, 251, 154, 107, 64, 235, 49, 128, 237, 148, 5, 102, 154,
    ],
    &[
        2, 4, 211, 177, 22, 22, 91, 134, 103, 93, 179, 209, 172, 84, 37, 92, 80, 171, 60, 122, 211,
        8, 176, 126, 224, 166, 84, 236, 244, 85, 46, 132, 26,
    ],
    &[
        3, 63, 222, 122, 139, 18, 132, 161, 247, 88, 66, 84, 141, 197, 117, 95, 101, 50, 71, 194,
        191, 122, 203, 185, 210, 98, 236, 173, 75, 154, 187, 172, 96,
    ],
    &[
        3, 44, 195, 111, 76, 231, 54, 153, 227, 93, 132, 122, 235, 212, 116, 182, 28, 25, 165, 88,
        119, 236, 163, 82, 104, 118, 213, 153, 192, 207, 30, 94, 94,
    ],
    &[
        3, 210, 39, 129, 24, 63, 96, 62, 55, 82, 204, 236, 190, 192, 205, 69, 74, 42, 40, 22, 93,
        247, 163, 31, 122, 70, 82, 237, 44, 91, 10, 209, 244,
    ],
    &[
        2, 33, 239, 177, 150, 226, 224, 118, 235, 141, 164, 135, 168, 10, 116, 10, 83, 36, 250,
        146, 169, 207, 190, 80, 62, 129, 221, 250, 45, 91, 90, 183, 72,
    ],
    &[
        3, 5, 235, 49, 166, 241, 237, 250, 162, 114, 151, 11, 155, 220, 54, 117, 192, 47, 204, 213,
        193, 219, 248, 1, 51, 244, 242, 123, 47, 93, 102, 84, 96,
    ],
    &[
        3, 138, 133, 229, 252, 59, 253, 254, 142, 214, 24, 33, 150, 165, 89, 26, 130, 60, 205, 187,
        0, 57, 54, 44, 68, 201, 238, 92, 16, 36, 14, 31, 180,
    ],
    &[
        2, 137, 193, 215, 107, 239, 83, 219, 232, 230, 178, 249, 150, 161, 125, 136, 8, 192, 115,
        177, 33, 230, 148, 188, 215, 203, 65, 186, 31, 149, 137, 190, 184,
    ],
    &[
        3, 171, 56, 195, 125, 16, 158, 35, 100, 110, 94, 161, 4, 248, 50, 54, 116, 190, 165, 59,
        16, 182, 191, 20, 58, 178, 220, 26, 25, 41, 41, 82, 145,
    ],
    &[
        3, 48, 215, 8, 141, 51, 228, 79, 115, 75, 21, 31, 10, 141, 193, 252, 196, 124, 233, 185,
        215, 99, 69, 11, 110, 188, 11, 207, 190, 72, 133, 134, 251,
    ],
    &[
        3, 253, 4, 205, 76, 34, 248, 77, 5, 1, 117, 118, 108, 215, 176, 86, 7, 72, 30, 228, 215,
        142, 130, 83, 167, 125, 5, 11, 185, 200, 203, 65, 195,
    ],
    &[
        3, 201, 254, 77, 73, 96, 38, 177, 81, 54, 68, 100, 80, 61, 166, 27, 88, 250, 93, 239, 140,
        215, 81, 207, 136, 199, 6, 104, 209, 87, 215, 214, 137,
    ],
    &[
        2, 199, 193, 32, 144, 212, 18, 234, 180, 221, 83, 23, 230, 199, 209, 125, 154, 248, 118,
        35, 41, 120, 37, 16, 234, 91, 107, 68, 175, 44, 20, 100, 73,
    ],
    &[
        2, 10, 123, 144, 30, 201, 186, 159, 28, 153, 255, 192, 130, 136, 248, 25, 129, 173, 109,
        180, 78, 101, 93, 99, 248, 221, 191, 105, 12, 127, 213, 124, 128,
    ],
    &[
        2, 225, 170, 207, 244, 153, 34, 206, 250, 142, 233, 81, 183, 172, 2, 35, 91, 250, 95, 26,
        246, 161, 78, 17, 109, 218, 71, 2, 183, 191, 230, 189, 241,
    ],
    &[
        3, 190, 152, 61, 15, 230, 213, 120, 18, 39, 168, 49, 99, 185, 170, 33, 75, 182, 164, 243,
        1, 135, 199, 191, 3, 111, 4, 151, 200, 187, 17, 52, 178,
    ],
    &[
        3, 48, 77, 69, 222, 130, 251, 14, 22, 113, 251, 250, 210, 167, 57, 215, 60, 43, 10, 33, 71,
        91, 179, 57, 94, 205, 160, 35, 4, 229, 31, 65, 202,
    ],
    &[
        3, 21, 38, 239, 95, 41, 196, 252, 43, 250, 137, 81, 137, 46, 178, 15, 135, 185, 0, 120,
        231, 251, 61, 87, 118, 220, 44, 5, 224, 194, 192, 208, 44,
    ],
    &[
        2, 18, 245, 102, 218, 137, 70, 144, 215, 224, 25, 132, 12, 122, 188, 66, 15, 135, 150, 185,
        19, 236, 44, 245, 200, 114, 247, 200, 117, 22, 157, 124, 146,
    ],
    &[
        2, 51, 199, 26, 178, 121, 165, 103, 39, 138, 127, 205, 178, 243, 132, 200, 0, 92, 127, 100,
        43, 241, 202, 224, 246, 221, 68, 148, 100, 203, 165, 242, 152,
    ],
    &[
        3, 194, 64, 151, 127, 195, 168, 4, 72, 50, 28, 161, 8, 54, 20, 128, 73, 74, 161, 227, 73,
        51, 202, 71, 184, 219, 39, 153, 229, 59, 231, 195, 96,
    ],
    &[
        3, 241, 135, 119, 65, 88, 64, 64, 188, 17, 26, 222, 233, 174, 77, 217, 67, 106, 37, 208,
        164, 213, 224, 146, 101, 45, 136, 0, 97, 16, 89, 164, 83,
    ],
    &[
        2, 16, 154, 172, 228, 102, 97, 253, 58, 25, 68, 92, 25, 40, 111, 20, 197, 12, 149, 231,
        111, 107, 214, 88, 20, 116, 83, 29, 41, 23, 26, 252, 229,
    ],
    &[
        2, 178, 60, 101, 141, 163, 188, 251, 236, 244, 155, 117, 236, 101, 217, 177, 154, 36, 225,
        219, 68, 197, 116, 2, 19, 137, 149, 237, 253, 54, 76, 110, 79,
    ],
    &[
        2, 119, 149, 241, 71, 74, 168, 161, 3, 202, 26, 120, 29, 46, 210, 215, 202, 117, 136, 255,
        185, 113, 129, 150, 148, 241, 229, 35, 159, 149, 170, 35, 115,
    ],
    &[
        2, 138, 20, 157, 100, 10, 117, 196, 135, 151, 7, 26, 147, 139, 169, 238, 92, 18, 99, 197,
        121, 24, 141, 164, 34, 53, 77, 197, 92, 164, 90, 87, 208,
    ],
    &[
        2, 210, 23, 24, 79, 151, 238, 253, 153, 247, 2, 46, 63, 215, 32, 190, 36, 202, 196, 232,
        194, 182, 9, 126, 238, 238, 29, 22, 40, 26, 100, 120, 181,
    ],
    &[
        2, 185, 157, 192, 41, 16, 21, 147, 136, 228, 157, 231, 65, 132, 135, 52, 91, 20, 126, 47,
        250, 35, 244, 10, 162, 152, 235, 157, 103, 146, 218, 225, 22,
    ],
    &[
        2, 244, 89, 105, 84, 82, 17, 21, 251, 190, 171, 243, 84, 252, 32, 184, 164, 67, 146, 34,
        77, 200, 139, 236, 221, 212, 137, 176, 3, 187, 108, 243, 130,
    ],
    &[
        2, 208, 145, 61, 35, 45, 151, 170, 43, 74, 216, 169, 112, 171, 223, 218, 148, 132, 174,
        167, 237, 37, 135, 16, 224, 220, 235, 243, 162, 133, 123, 139, 162,
    ],
    &[
        2, 243, 25, 108, 31, 74, 1, 201, 193, 98, 170, 219, 14, 26, 158, 245, 167, 244, 242, 57,
        34, 87, 79, 151, 217, 43, 147, 189, 149, 54, 69, 29, 144,
    ],
    &[
        2, 6, 36, 211, 248, 81, 104, 144, 41, 225, 155, 26, 181, 34, 86, 183, 255, 164, 141, 159,
        241, 36, 79, 143, 147, 255, 208, 65, 26, 94, 34, 245, 103,
    ],
    &[
        3, 251, 24, 78, 212, 201, 34, 17, 219, 116, 248, 73, 243, 80, 130, 217, 35, 70, 70, 183,
        231, 11, 85, 183, 117, 86, 45, 9, 13, 214, 60, 221, 50,
    ],
];

/// The group of points generated by H.
/// This is used to calculate the seed parameter from blinding factors.
///
/// For details: https://eprint.iacr.org/2020/735
const RAW_H_BOLD1: &[&[u8]] = &[
    &[
        2, 84, 215, 144, 203, 236, 60, 134, 241, 154, 27, 145, 175, 147, 119, 119, 15, 251, 12,
        246, 182, 30, 171, 149, 109, 214, 231, 200, 16, 62, 153, 104, 132,
    ],
    &[
        3, 153, 37, 64, 191, 150, 194, 35, 217, 33, 228, 80, 198, 211, 255, 202, 172, 155, 64, 244,
        8, 186, 33, 179, 202, 129, 161, 172, 182, 71, 92, 193, 117,
    ],
    &[
        2, 23, 129, 28, 151, 123, 112, 83, 158, 164, 57, 55, 173, 41, 79, 95, 94, 58, 94, 86, 73,
        171, 53, 132, 91, 243, 126, 78, 245, 229, 44, 219, 110,
    ],
    &[
        3, 57, 41, 146, 211, 167, 233, 169, 228, 216, 50, 112, 237, 54, 154, 220, 77, 134, 154, 86,
        20, 98, 150, 105, 73, 69, 199, 0, 240, 6, 34, 83, 170,
    ],
    &[
        3, 173, 110, 223, 130, 114, 185, 139, 175, 175, 113, 185, 243, 129, 186, 84, 213, 22, 106,
        191, 130, 56, 33, 170, 41, 125, 214, 205, 183, 75, 80, 110, 101,
    ],
    &[
        2, 95, 15, 79, 94, 17, 174, 152, 83, 99, 66, 153, 0, 46, 237, 156, 62, 208, 154, 15, 90,
        14, 51, 12, 171, 184, 51, 184, 196, 138, 70, 33, 144,
    ],
    &[
        3, 166, 119, 158, 3, 73, 204, 15, 86, 155, 64, 4, 125, 20, 8, 206, 242, 189, 84, 105, 84,
        80, 191, 184, 206, 149, 5, 196, 148, 247, 71, 2, 78,
    ],
    &[
        3, 36, 2, 83, 210, 96, 73, 33, 106, 174, 31, 46, 45, 102, 253, 203, 161, 121, 105, 29, 85,
        81, 128, 129, 63, 15, 143, 161, 149, 201, 131, 190, 11,
    ],
    &[
        3, 15, 38, 136, 180, 200, 3, 118, 170, 66, 160, 57, 139, 47, 92, 33, 178, 226, 254, 11, 9,
        219, 88, 169, 147, 129, 202, 6, 21, 77, 221, 192, 244,
    ],
    &[
        3, 107, 144, 29, 138, 98, 113, 184, 159, 110, 0, 75, 247, 218, 31, 22, 134, 38, 102, 58,
        41, 220, 203, 234, 90, 5, 131, 211, 110, 95, 21, 131, 149,
    ],
    &[
        2, 145, 201, 175, 176, 74, 208, 82, 152, 110, 163, 109, 1, 76, 147, 229, 102, 108, 2, 4, 6,
        138, 101, 153, 234, 124, 15, 126, 47, 90, 116, 130, 233,
    ],
    &[
        3, 9, 33, 109, 84, 40, 170, 60, 1, 181, 250, 185, 163, 60, 145, 86, 120, 216, 61, 60, 216,
        49, 52, 64, 155, 90, 229, 182, 60, 168, 236, 1, 163,
    ],
    &[
        2, 193, 87, 94, 58, 142, 255, 118, 46, 247, 153, 32, 10, 138, 198, 98, 62, 131, 76, 170,
        41, 13, 116, 32, 117, 115, 54, 187, 206, 88, 189, 94, 171,
    ],
    &[
        2, 96, 250, 99, 214, 205, 220, 14, 42, 193, 166, 219, 180, 13, 229, 22, 73, 129, 16, 160,
        52, 242, 114, 63, 104, 128, 210, 153, 167, 110, 114, 115, 44,
    ],
    &[
        3, 78, 82, 211, 120, 126, 78, 60, 42, 51, 210, 116, 54, 201, 101, 50, 253, 217, 127, 112,
        53, 40, 81, 43, 174, 111, 115, 149, 210, 66, 229, 106, 196,
    ],
    &[
        2, 119, 81, 94, 250, 45, 99, 12, 207, 150, 231, 54, 98, 126, 106, 126, 28, 121, 165, 172,
        60, 130, 94, 133, 27, 66, 58, 195, 20, 95, 92, 91, 212,
    ],
    &[
        3, 176, 151, 192, 152, 167, 113, 115, 33, 144, 215, 70, 134, 116, 144, 139, 24, 104, 39,
        169, 137, 44, 174, 181, 13, 80, 112, 252, 181, 26, 74, 109, 153,
    ],
    &[
        3, 18, 237, 174, 6, 54, 61, 60, 1, 140, 231, 199, 51, 69, 158, 8, 110, 41, 40, 161, 0, 90,
        50, 157, 130, 229, 228, 156, 59, 10, 48, 107, 61,
    ],
    &[
        2, 203, 10, 200, 102, 67, 169, 49, 255, 61, 210, 26, 241, 162, 214, 155, 54, 211, 249, 249,
        245, 111, 223, 67, 233, 102, 137, 35, 24, 103, 114, 165, 72,
    ],
    &[
        3, 79, 6, 161, 87, 49, 93, 101, 134, 113, 133, 171, 171, 236, 169, 176, 219, 214, 144, 135,
        80, 154, 206, 55, 77, 20, 21, 204, 79, 101, 226, 47, 163,
    ],
    &[
        3, 33, 43, 174, 120, 110, 214, 170, 121, 116, 67, 169, 196, 6, 115, 50, 139, 205, 242, 69,
        232, 19, 188, 40, 127, 201, 11, 173, 3, 37, 184, 46, 123,
    ],
    &[
        3, 192, 227, 83, 67, 165, 197, 189, 223, 85, 248, 6, 117, 146, 144, 102, 189, 176, 137,
        120, 160, 213, 76, 155, 51, 34, 89, 191, 83, 106, 96, 117, 109,
    ],
    &[
        2, 81, 31, 122, 251, 225, 72, 232, 154, 54, 245, 122, 105, 209, 165, 45, 168, 196, 78, 230,
        176, 82, 129, 239, 175, 136, 138, 226, 235, 195, 193, 104, 64,
    ],
    &[
        2, 77, 91, 204, 124, 194, 206, 226, 170, 248, 143, 67, 72, 142, 7, 255, 205, 160, 237, 203,
        239, 73, 29, 6, 154, 157, 226, 51, 79, 57, 171, 57, 17,
    ],
    &[
        3, 35, 208, 8, 17, 223, 230, 149, 112, 154, 16, 237, 30, 177, 2, 207, 21, 169, 2, 151, 149,
        43, 236, 158, 108, 215, 129, 157, 68, 173, 23, 16, 237,
    ],
    &[
        3, 73, 77, 192, 254, 166, 168, 169, 247, 26, 138, 250, 109, 236, 177, 155, 129, 55, 41, 13,
        130, 134, 119, 204, 60, 232, 89, 218, 175, 10, 193, 213, 19,
    ],
    &[
        2, 208, 242, 12, 7, 132, 76, 107, 147, 104, 92, 232, 175, 7, 70, 108, 219, 107, 180, 35,
        39, 85, 50, 159, 248, 24, 47, 160, 234, 110, 29, 197, 18,
    ],
    &[
        2, 223, 152, 221, 105, 172, 129, 67, 68, 119, 116, 230, 90, 121, 229, 217, 121, 81, 64,
        212, 66, 201, 191, 125, 250, 50, 57, 220, 11, 212, 115, 124, 60,
    ],
    &[
        3, 15, 70, 12, 129, 19, 178, 41, 117, 4, 170, 246, 177, 1, 145, 225, 234, 169, 197, 46, 89,
        96, 177, 31, 134, 80, 87, 225, 176, 34, 56, 51, 74,
    ],
    &[
        2, 237, 74, 152, 183, 198, 235, 161, 97, 123, 124, 77, 109, 116, 8, 62, 214, 183, 6, 236,
        35, 91, 70, 109, 251, 65, 101, 253, 16, 225, 55, 116, 178,
    ],
    &[
        3, 190, 51, 117, 181, 145, 111, 4, 206, 115, 19, 77, 40, 141, 203, 76, 73, 180, 73, 233,
        175, 10, 76, 102, 18, 44, 148, 86, 130, 110, 121, 238, 125,
    ],
    &[
        2, 125, 51, 25, 148, 216, 37, 192, 230, 38, 128, 194, 196, 245, 103, 72, 157, 136, 125, 58,
        234, 91, 163, 17, 111, 8, 109, 91, 84, 19, 93, 11, 37,
    ],
    &[
        2, 150, 143, 91, 87, 120, 38, 232, 121, 173, 22, 65, 160, 177, 223, 128, 62, 153, 99, 142,
        79, 25, 128, 150, 218, 139, 36, 195, 199, 101, 17, 90, 161,
    ],
    &[
        2, 254, 52, 164, 90, 214, 118, 184, 23, 97, 230, 96, 102, 248, 62, 82, 2, 93, 241, 128, 27,
        105, 139, 254, 123, 137, 96, 210, 107, 217, 208, 128, 7,
    ],
    &[
        2, 82, 101, 39, 105, 237, 205, 57, 75, 220, 189, 11, 44, 176, 225, 115, 5, 89, 126, 249,
        196, 174, 19, 253, 121, 207, 183, 14, 171, 243, 138, 172, 109,
    ],
    &[
        3, 106, 57, 96, 167, 228, 238, 77, 0, 75, 246, 109, 226, 149, 201, 164, 72, 66, 8, 165, 90,
        56, 46, 180, 63, 202, 111, 24, 88, 254, 230, 59, 172,
    ],
    &[
        2, 66, 46, 239, 202, 53, 251, 159, 228, 192, 170, 71, 4, 158, 238, 227, 95, 21, 249, 199,
        210, 184, 46, 28, 215, 226, 252, 153, 48, 116, 111, 122, 17,
    ],
    &[
        3, 218, 65, 64, 178, 63, 163, 66, 28, 94, 127, 184, 229, 198, 157, 32, 184, 111, 74, 43,
        168, 67, 186, 244, 193, 101, 195, 254, 234, 215, 44, 11, 82,
    ],
    &[
        3, 133, 103, 229, 103, 106, 32, 6, 162, 27, 73, 169, 233, 9, 243, 244, 199, 245, 193, 96,
        205, 160, 217, 49, 14, 160, 124, 216, 123, 127, 201, 57, 43,
    ],
    &[
        2, 65, 249, 229, 140, 171, 153, 234, 207, 237, 5, 100, 97, 113, 185, 6, 39, 80, 187, 39,
        170, 84, 0, 254, 254, 177, 158, 244, 33, 117, 173, 101, 3,
    ],
    &[
        2, 24, 66, 227, 78, 246, 9, 225, 5, 164, 145, 113, 59, 159, 142, 6, 235, 210, 161, 230,
        176, 186, 188, 199, 23, 238, 237, 14, 79, 134, 69, 3, 111,
    ],
    &[
        2, 197, 64, 65, 6, 163, 50, 107, 136, 203, 192, 79, 13, 81, 25, 61, 32, 61, 53, 167, 49,
        37, 114, 174, 250, 245, 211, 54, 190, 54, 202, 14, 12,
    ],
    &[
        2, 164, 118, 38, 201, 101, 97, 118, 37, 129, 93, 179, 194, 163, 106, 99, 60, 14, 89, 15,
        114, 240, 227, 219, 1, 114, 183, 168, 174, 120, 54, 208, 115,
    ],
    &[
        2, 0, 137, 72, 183, 194, 142, 4, 172, 95, 200, 113, 189, 172, 168, 196, 134, 102, 234, 33,
        53, 149, 101, 66, 34, 78, 201, 170, 183, 58, 141, 145, 70,
    ],
    &[
        2, 54, 196, 217, 93, 234, 142, 159, 44, 106, 237, 133, 203, 33, 198, 135, 158, 189, 157,
        249, 101, 135, 188, 13, 63, 51, 54, 21, 155, 127, 197, 38, 228,
    ],
    &[
        3, 25, 59, 175, 227, 63, 177, 237, 26, 140, 246, 255, 245, 150, 41, 107, 102, 239, 154,
        150, 140, 186, 138, 224, 75, 161, 141, 151, 251, 42, 99, 86, 132,
    ],
    &[
        3, 188, 90, 46, 244, 123, 178, 53, 44, 119, 225, 60, 171, 3, 231, 189, 21, 195, 250, 211,
        94, 154, 93, 37, 175, 27, 192, 183, 163, 47, 243, 160, 121,
    ],
    &[
        3, 248, 129, 229, 209, 83, 32, 119, 85, 231, 255, 250, 82, 159, 47, 99, 171, 66, 20, 121,
        27, 18, 252, 236, 43, 66, 210, 160, 80, 89, 81, 68, 245,
    ],
    &[
        2, 248, 19, 87, 201, 123, 44, 76, 194, 165, 152, 221, 3, 123, 158, 188, 180, 240, 47, 59,
        194, 70, 222, 86, 107, 228, 225, 78, 234, 94, 217, 7, 103,
    ],
    &[
        3, 121, 33, 156, 231, 188, 186, 189, 232, 65, 247, 172, 187, 16, 8, 99, 144, 39, 238, 96,
        206, 197, 109, 65, 48, 71, 14, 196, 241, 54, 76, 215, 9,
    ],
    &[
        3, 106, 97, 21, 190, 128, 151, 94, 73, 86, 243, 130, 252, 44, 11, 17, 36, 162, 152, 96, 29,
        63, 171, 221, 203, 49, 110, 27, 230, 243, 107, 197, 74,
    ],
    &[
        3, 232, 157, 71, 36, 230, 81, 118, 94, 162, 157, 1, 26, 113, 21, 174, 233, 155, 210, 84,
        137, 83, 118, 51, 24, 134, 141, 198, 34, 195, 163, 179, 245,
    ],
    &[
        2, 230, 68, 140, 163, 142, 177, 72, 165, 131, 67, 21, 66, 28, 61, 79, 42, 224, 27, 246,
        157, 151, 179, 92, 119, 122, 227, 57, 161, 251, 149, 202, 121,
    ],
    &[
        3, 10, 79, 235, 34, 157, 87, 103, 12, 104, 1, 176, 23, 214, 190, 151, 99, 76, 188, 114,
        243, 96, 193, 41, 119, 94, 84, 171, 66, 65, 252, 144, 133,
    ],
    &[
        3, 181, 182, 97, 57, 191, 134, 215, 60, 227, 207, 100, 55, 249, 29, 54, 124, 107, 242, 185,
        252, 50, 182, 255, 129, 6, 192, 83, 68, 233, 115, 99, 209,
    ],
    &[
        2, 10, 76, 220, 254, 20, 82, 203, 13, 106, 225, 21, 183, 5, 107, 51, 112, 36, 26, 88, 169,
        114, 223, 123, 198, 15, 38, 80, 168, 95, 141, 157, 31,
    ],
    &[
        3, 240, 132, 223, 106, 248, 137, 37, 204, 92, 169, 64, 93, 153, 216, 137, 196, 92, 9, 2,
        84, 0, 29, 68, 161, 15, 212, 132, 42, 228, 235, 31, 120,
    ],
    &[
        2, 22, 249, 233, 208, 196, 20, 43, 108, 238, 221, 192, 140, 62, 97, 45, 98, 92, 72, 204,
        12, 45, 103, 40, 142, 99, 223, 42, 154, 54, 159, 146, 143,
    ],
    &[
        2, 101, 81, 66, 104, 247, 233, 107, 194, 187, 126, 89, 130, 36, 42, 146, 80, 41, 200, 231,
        211, 238, 59, 99, 123, 168, 195, 51, 210, 181, 1, 181, 53,
    ],
    &[
        3, 5, 228, 92, 82, 138, 199, 46, 128, 74, 78, 127, 124, 185, 204, 124, 195, 182, 230, 43,
        43, 49, 19, 108, 140, 236, 227, 113, 229, 218, 6, 154, 204,
    ],
    &[
        3, 193, 188, 57, 130, 2, 254, 77, 21, 233, 251, 113, 185, 186, 59, 199, 227, 142, 188, 110,
        205, 87, 16, 87, 121, 193, 35, 165, 167, 96, 165, 86, 224,
    ],
    &[
        3, 123, 39, 117, 182, 201, 184, 57, 234, 12, 107, 82, 90, 37, 40, 13, 64, 45, 75, 160, 31,
        125, 243, 23, 141, 174, 13, 35, 231, 242, 197, 49, 159,
    ],
    &[
        3, 72, 131, 58, 252, 203, 5, 16, 48, 197, 169, 39, 90, 96, 97, 72, 164, 247, 99, 220, 50,
        227, 61, 32, 65, 110, 31, 208, 190, 18, 68, 31, 103,
    ],
    &[
        3, 199, 67, 64, 10, 126, 18, 205, 38, 37, 166, 133, 30, 195, 206, 62, 19, 96, 214, 31, 206,
        31, 16, 159, 84, 49, 225, 172, 17, 77, 190, 160, 19,
    ],
];

lazy_static::lazy_static! {
    /// The generator point of the secp256k1 curve.
    pub static ref G: k256::ProjectivePoint = to_point_uncompressed(&[
        4, 121, 190, 102, 126, 249, 220, 187, 172, 85, 160, 98, 149, 206, 135, 11, 7, 2, 155, 252, 219,
        45, 206, 40, 217, 89, 242, 129, 91, 22, 248, 23, 152, 72, 58, 218, 119, 38, 163, 196, 101, 93,
        164, 251, 252, 14, 17, 8, 168, 253, 23, 180, 72, 166, 133, 84, 25, 156, 71, 208, 143, 251, 16,
        212, 184
    ]).expect("valid point");

    /// The generator point of the secp256k1 curve, derived from G.
    pub static ref H: k256::ProjectivePoint = to_point_uncompressed(&[
        4, 80, 146, 155, 116, 193, 160, 73, 84, 183, 139, 75, 96, 53, 233, 122, 94, 7, 138, 90, 15, 40,
        236, 150, 213, 71, 191, 238, 154, 206, 128, 58, 192, 49, 211, 198, 134, 57, 115, 146, 110, 4,
        158, 99, 124, 177, 181, 244, 10, 54, 218, 194, 138, 241, 118, 105, 104, 195, 12, 35, 19, 243,
        163, 137, 4,
    ]).expect("valid point");

    /// The group of points generated by G.
    /// This is used to calculate the seed parameter from blinding factors.
    pub static ref G_BOLD1: Vec<k256::ProjectivePoint> = RAW_G_BOLD1
        .iter()
        .map(|raw| {
            to_point(raw)
                .expect("valid point")
        })
        .collect::<Vec<_>>();

    /// The group of points generated by H.
    /// This is used to calculate the seed parameter from blinding factors.
    pub static ref H_BOLD1: Vec<k256::ProjectivePoint> = RAW_H_BOLD1
        .iter()
        .map(|raw| {
            to_point(raw)
                .expect("valid point")
        })
        .collect::<Vec<_>>();
}

pub(crate) fn to_point(point: &[u8]) -> Option<k256::ProjectivePoint> {
    let mut encoding = <k256::ProjectivePoint as GroupEncoding>::Repr::default();
    encoding.copy_from_slice(point);

    let point = k256::ProjectivePoint::from_bytes(&encoding);
    if point.is_some().into() {
        return Some(point.expect("valid point"));
    }

    None
}

pub(crate) fn to_point_uncompressed(raw_point: &[u8]) -> Option<k256::ProjectivePoint> {
    let encoded_point = k256::EncodedPoint::from_bytes(raw_point).ok()?;

    let projective_point = k256::ProjectivePoint::from_encoded_point(&encoded_point);
    if projective_point.is_none().into() {
        return None;
    }

    let compressed_point = projective_point.expect("valid point").to_bytes().to_vec();

    let mut encoding = <k256::ProjectivePoint as GroupEncoding>::Repr::default();
    encoding.copy_from_slice(&compressed_point);

    let point = k256::ProjectivePoint::from_bytes(&encoding);
    if point.is_some().into() {
        return Some(point.expect("valid point"));
    }

    None
}

pub(crate) fn to_scalar(bytes: &[u8]) -> Option<k256::Scalar> {
    let mut repr = <k256::Scalar as PrimeField>::Repr::default();
    repr.copy_from_slice(bytes);
    k256::Scalar::from_repr(repr).into()
}

pub(crate) fn hash_to_point(msg: &[u8]) -> k256::Scalar {
    let mut hasher = Sha256::new();

    hasher.update(msg);

    k256::Scalar::from_repr(hasher.finalize()).expect("valid scalar")
}
